\documentclass{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[top=2cm,bottom=2cm,left=1.5cm,right=1.5cm]{geometry}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{euscript}

\newcommand{\sgn}{\operatorname{sign}}

\bibliographystyle{gost71s}

\begin{document}
\section{Постановка задачи}
Рассматривается задача создания цифровых водяных знаков (digital watermarking) для 2D-векторных данных. Сформулируем ее следующим образом. Есть карта -- набор точек плоскости, заданных своими координатами, мы хотим добавить (внедрить) в нее некоторую информацию -- наше имя, название компании или что-то еще, что однозначно идентифицирует нас.
Естественно, у нас должен быть способ затем извлечь эту информацию из модифицированной карты.
В открытый доступ выкладывается только модифицированный нами вариант, таким образом в случае несанкционированного копирования наших данных мы сможем доказать авторство. 

Скопировав карту, злоумышленник может ее атаковать -- немного изменить, c целью разрушить водяные знаки, не сильно исказив при этом исходные данные. Соответственно, к водяным знакам предъявляется требование -- устойчивость против различного рода атак, то есть сохранение возможности извлечения внедренной информации из несильно измененной копии наших данных. 
Второе естественное требование, предъявляемое алгоритму внедрения,~-- он не должен сильно искажать исходные данные.

\section{Базовый алгоритм}
Автором предлагается небольшая модификация алгоритма предложенного Ohbuchi в \cite{Ohbuchi}. В смысле устойчивости к атакам это лучший алгоритм
из известных автору (\cite{Bazin}, \cite{Voight}, \cite{Kim}, \cite{Chang}, \cite{Li}). Изложим его в несколько упрощенном варианте.
На входе алгоритма внедрения водяных знаков -- множество точек $V = \left\{v_1, v_2, ... , v_n\right\}$. Давайте построим триангуляцию Делоне $\mathfrak{T}$ множества $V$, и рассмотрим граф триангуляции $G(\mathfrak{T})$. Найдем его собственные вектора, как собственные вектора матрицы $R = I - HA$, где 
$H_{ij} = \begin{cases} 1 / deg_i\mbox{ если }i = j, \\ 0\mbox{ иначе;} \end{cases}$ $A$ -- матрица смежности графа $G$. Построим из собственных векторов ортонормированный базис $\mathbb{R}^n$ 
$\{e_i\}_{i=1}^n$, $n = |V|$. Разложим в этом базисе векторы $x = (x_1, x_2, \dots, x_n)^T, y = (y_1, y_2, \dots, y_n)^T$, $(x_i, y_i) = v_i$ : 
$x = r_1 e_1 + r_2 e_2 + \dots + r_n e_n, y = s_1 e_1 + s_2 e_2 + \dots + s_n e_n$. 
Если мы хотим внедрить в карту $k$  информационных бит $m_i \in \left\{-1, 1 \right\} i = 1..k$, то изменим $k$ координат $(r_i, s_i), i = 1..k$ 
векторов $x, y$ в базисе $\{e_i\}$ на величину $m_i p_i \alpha$, где $\alpha$ некоторый коэффициент, а $\left\{p_i \in \{-1, 1\} \right\}$ -- псевдослучайная последовательность бит, 
сгенерированная с помощью некоторого закрытого ключа. Соответственно, выходом алгоритма внедрения будет множества $V' = \left\{ v_1', v_2', \dots , v_n' \right\}, v_i = (x_i, y_i), 
x = \sum_{i=1}^n r_i' e_i, y = \sum_{i=1}^n s_i' e_i$; \begin{equation}\label{MainFormul} r_i' = r_i + m_i p_i \alpha,\mbox{  } s_i' = s_i + m_i p_i \alpha. \end{equation}

Будем считать, что на вход алгоритма извлечения водяных знаков поступает множество точек $V'' = \left\{v_1'', v_2'', \dots , v_n''\right\}$, причем $|V''| = |V| = |V'|$, и 
$distance(v_i', v_i'') < \epsilon$, где $\epsilon$ -- небольшая погрешность. То есть, мы предполагаем, что злоумышленник только добавил какой-то шум к координатам вершин. Мы вправе предполагать это, так как существуют способы борьбы с другими способами атак или сведения их к небольшим смещениям вершин. При этих предположениях мы извлекаем $i$-й бит как
$m_i = \sgn( p_i * ( r_i'' + s_i'') )$, где $r_i'' = (e_i, \Delta x), s_i'' = (e_i, \Delta y)$ -- координаты векторов $\Delta x, \Delta y$ в базисе $\{e_i\}_{i=1}^n$, 
$(\Delta x_i, \Delta y_i) = (v_i'' - v_i)$. 

Эксперименты показывают, что предлагаемый Ohbuchi алгоритм имеют хорошую устойчивость против атак, однако не приводится никаких соображений, почему внедряемые водяные знаки не сильно искажают исходные данные, и так ли это в принципе. 

\section{Оценка искажения}
Давайте рассмотрим алгоритм внедрения, как функцию $f: V \to \mathbb{R}^2$, сопоставляющую точкам карты их смещения. Продолжим $f$ на $\Omega = Conv(V)$ -- выпуклую оболочку $V$. Это естественно делать с помощью PLIS (Piecewise Linear Interpolation Surface) 
по некоторой триангуляции $\mathfrak{T}$ множества $V$. Действительно, если $f(v_1)~=~v_1, f(v_2)~=~f_2, f(v_3)~=~f_3$, то образом точки $v = \alpha v_1 + \beta v_2 + \gamma v_3, 
\alpha, \beta, \gamma \in [0, 1], \alpha + \beta + \gamma = 1$ при преобразовании карты логично образом точки $v$ считать точку $v' = v + \alpha f(v_1) + \beta f(v_2) + \gamma f(v_3)$, то есть $f(v) = v - v'$ есть линейная интерполяция $f_1, f_2, f_3$, если $\triangle T = (v_1, v_2, v_3) \in \mathfrak{T}$.
В качестве триангуляции $\mathfrak{T}$ выгодно взять триангуляцию Делоне, так как, согласно теореме Rippa (\cite{Rippa}, \cite{Chen}), она минимизирует погрешность PLIS.

В качестве меры искажения исходной карты предлагается взять $E_D(f) = \frac{1}{2} \int_{\Omega}{||\nabla f||^2}d\Omega$. Эта мера представляется разумной, так как $||\nabla f||$ есть величина, показывающая максимальное изменение $f$ в некоторой точке $v$, то есть максимум того, насколько 
$v$ и некоторая близкая к ней точка $v + dv$ ``разъезжаются''.
Как показано в \cite{Pinkall93} в случае, когда $f$ есть PLIS множества вершин $V$ по триангуляции $\mathfrak{T}$, 
\begin{equation*}
  E_D(f) = \frac{1}{4} \sum_{\triangle (i, j, k) \in \mathfrak{T}}
  {\ctg{\alpha_{ij}}||f_i - f_j||^2 + \ctg{\alpha_{jk}}||f_j - f_k||^2 + \ctg{\alpha_{ki}}||f_k - f_i||^2},
\end{equation*}
где $f_{\left\{i, j, k\right\}} = f(v_{\left\{i, j, k\right\}})$, $\alpha_{ij}$ -- угол противолежащий ребру $(v_i, v_j)$ в треугольнике $\triangle T = v_i v_j v_k$.
Эта формула эквивалентна
\begin{equation*}
  E_D(f) = \frac{1}{2} \sum_{\left( i, j \right) \in E\left(\mathfrak{T}\right)}{w_{ij} ||f_i - f_j||^2}, 
\end{equation*}

где $E(\mathfrak{T})$ -- множество ребер триангуляции, $w_{ij} = \frac{1}{2}\left(\ctg\alpha_{ij} + \ctg\alpha_{ji}\right)$, $\alpha_{\left\{{ij, ji}\right\}}$ -- углы противолежащие 
ребру~$(v_i, v_j)$ в cоседних треугольниках $\triangle T_1 = v_i v_j v_{k_1}, \triangle T_2 = v_j v_i v_{k_2}$.
Пусть $G$ -- взвешенный граф триангуляции~$\mathfrak{T}$, $V(G) = V, E(G) = E(\mathfrak{T})$, $weight(u, v) = w_{uv}$. Если рассмотреть лапласиан $L$ графа $G$ -- матрицу $n \times n$, 
где $n = |V(G)|$, $L_{uv} = \begin{cases}
  \sum_{(v, x) \in E(G)}{w_{vx}}\mbox{ при }&\text{$u = v;$} \\
  -w_{uv}\mbox{ при }&\text{$u \sim v;$} \\
  0 &\text{иначе;}
    \end{cases}$ то последнюю формулу можно переписать в виде 
\begin{equation*}
  E_D(f) = \frac{1}{2} f^T L f, 
\end{equation*}
где $f = (f_1, f_2, \dots f_n)^T$. Откуда видно (\cite{Ross}), что, для $f = \alpha \sum_{i=1}^k p_i e_i$, где $\alpha$ -- некоторое число, $p_i \in \{-1, 1 \}$, 
$\left\{e_i\right\}_{i=1}^k$ -- набор ортонормированных векторов в $\mathbb{R}^n$, минимум энергии $E_D(f)$ достигается при $e_i$ равных собственным векторам 
$L$, соответствующим $k$ наименьшим собственным числам.  

\section{Выводы}
Если модифицировать алгоритм Ohbuchi внедрения водяных знаков, так чтобы для изменения по формуле~(\ref{MainFormul}) выбиралось $k$ наименьших координат векторов $x, y$ 
в базисе собственных векторов взвешенного графа триангуляции~Делоне, то минимизируется искажения исходных данных в смысле предложенной меры 
$E_D(f) = \frac{1}{2} \int_{\Omega}{||\nabla f||^2} d\Omega$. Численные эксперименты показали, что минимизируя по этой мере, мы минимизируем среднее изменение углов исходной карты, 
что довольно ощутимо влияет на визуальное восприятие.
Так для карты зданий Петербурга -- набора полигонов -- при коэффициенте $\alpha$ из формулы~(\ref{MainFormul}) равном $0.1$ и отношении числа внедряемых бит к числу вершин графа 
$k / n \approx \frac{1}{3}$ среднее изменение угла при внедрении водяных знаков по оригинальному алгоритму Обучи $\approx 1.72^\circ$, а при предложенной модификации -- 
$\approx 0.97^\circ$. Единица длины на карте~--~1 м, соответственно, характерная длина стороны прямоугольника ограничивающего некоторый полигон (здание) -- 10--100 единиц.
Параметр $\alpha$ выбирался таким образом, чтобы обеспечить защиту от добавления к координатам вершин гауссовского шума с дисперсией~1.5. 
 
\bibliography{doc}

\end{document}
